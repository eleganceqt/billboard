/*!
 * # Semantic UI 2.0.0 - Video
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2014 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(h,e,f,g){h.fn.video=function(a){var c=h(this),p=c.selector||"",s=new Date().getTime(),d=[],o=arguments[0],t=(typeof o=="string"),b=[].slice.call(arguments,1),q=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame||function(i){setTimeout(i,0)},r;c.each(function(){var j=(h.isPlainObject(a))?h.extend(true,{},h.fn.video.settings,a):h.extend({},h.fn.video.settings),N=j.selector,I=j.className,H=j.error,n=j.metadata,P=j.namespace,l=j.templates,O="."+P,L="module-"+P,k=h(e),G=h(this),J=G.find(N.placeholder),m=G.find(N.playButton),K=G.find(N.embed),M=this,i=G.data(L),F;F={initialize:function(){F.debug("Initializing video");F.create();G.on("click"+O,N.placeholder,F.play).on("click"+O,N.playButton,F.play);F.instantiate()},instantiate:function(){F.verbose("Storing instance of module",F);i=F;G.data(L,F)},create:function(){var u=G.data(n.image),v=l.video(u);G.html(v);F.refresh();if(!u){F.play()}F.debug("Creating html for video element",v)},destroy:function(){F.verbose("Destroying previous instance of video");F.reset();G.removeData(L).off(O)},refresh:function(){F.verbose("Refreshing selector cache");J=G.find(N.placeholder);m=G.find(N.playButton);K=G.find(N.embed)},change:function(v,u,w){F.debug("Changing video to ",v,u,w);G.data(n.source,v).data(n.id,u).data(n.url,w);j.onChange()},reset:function(){F.debug("Clearing video embed and showing placeholder");G.removeClass(I.active);K.html(" ");J.show();j.onReset()},play:function(){F.debug("Playing video");var v=G.data(n.source)||false,w=G.data(n.url)||false,u=G.data(n.id)||false;K.html(F.generate.html(v,u,w));G.addClass(I.active);j.onPlay()},get:{source:function(u){if(typeof u!=="string"){return false}if(u.search("youtube.com")!==-1){return"youtube"}else{if(u.search("vimeo.com")!==-1){return"vimeo"}}return false},id:function(u){if(u.match(j.regExp.youtube)){return u.match(j.regExp.youtube)[1]}else{if(u.match(j.regExp.vimeo)){return u.match(j.regExp.vimeo)[2]}}return false}},generate:{html:function(v,u,x){F.debug("Generating embed html");var w;v=v||j.source;u=u||j.id;if((v&&u)||x){if(!v||!u){v=F.get.source(x);u=F.get.id(x)}if(v=="vimeo"){w='<iframe src="//player.vimeo.com/video/'+u+"?="+F.generate.url(v)+'" width="100%" height="100%" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}else{if(v=="youtube"){w='<iframe src="//www.youtube.com/embed/'+u+"?="+F.generate.url(v)+'" width="100%" height="100%" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}}}else{F.error(H.noVideo)}return w},url:function(w){var z=(j.api)?1:0,x=(j.autoplay==="auto")?(G.data("image")!==g):j.autoplay,u=(j.hd)?1:0,y=(j.showUI)?1:0,v=!(j.showUI)?1:0,A="";if(w=="vimeo"){A="api="+z+"&amp;title="+y+"&amp;byline="+y+"&amp;portrait="+y+"&amp;autoplay="+x;if(j.color){A+="&amp;color="+j.color}}if(w=="ustream"){A="autoplay="+x;if(j.color){A+="&amp;color="+j.color}}else{if(w=="youtube"){A="enablejsapi="+z+"&amp;autoplay="+x+"&amp;autohide="+v+"&amp;hq="+u+"&amp;modestbranding=1";if(j.color){A+="&amp;color="+j.color}}}return A}},setting:function(v,u){F.debug("Changing setting",v,u);if(h.isPlainObject(v)){h.extend(true,j,v)}else{if(u!==g){j[v]=u}else{return j[v]}}},internal:function(v,u){if(h.isPlainObject(v)){h.extend(true,F,v)}else{if(u!==g){F[v]=u}else{return F[v]}}},debug:function(){if(j.debug){if(j.performance){F.performance.log(arguments)}else{F.debug=Function.prototype.bind.call(console.info,console,j.name+":");F.debug.apply(console,arguments)}}},verbose:function(){if(j.verbose&&j.debug){if(j.performance){F.performance.log(arguments)}else{F.verbose=Function.prototype.bind.call(console.info,console,j.name+":");F.verbose.apply(console,arguments)}}},error:function(){F.error=Function.prototype.bind.call(console.error,console,j.name+":");F.error.apply(console,arguments)},performance:{log:function(v){var w,u,x;if(j.performance){w=new Date().getTime();x=s||w;u=w-x;s=w;d.push({Name:v[0],Arguments:[].slice.call(v,1)||"",Element:M,"Execution Time":u})}clearTimeout(F.performance.timer);F.performance.timer=setTimeout(F.performance.display,500)},display:function(){var u=j.name+":",v=0;s=false;clearTimeout(F.performance.timer);h.each(d,function(x,w){v+=w["Execution Time"]});u+=" "+v+"ms";if(p){u+=" '"+p+"'"}if(c.length>1){u+=" ("+c.length+")"}if((console.group!==g||console.table!==g)&&d.length>0){console.groupCollapsed(u);if(console.table){console.table(d)}else{h.each(d,function(x,w){console.log(w.Name+": "+w["Execution Time"]+"ms")})}console.groupEnd()}d=[]}},invoke:function(v,z,x){var y=i,u,w,A;z=z||b;x=M||x;if(typeof v=="string"&&y!==g){v=v.split(/[\. ]/);u=v.length-1;h.each(v,function(B,C){var D=(B!=u)?C+v[B+1].charAt(0).toUpperCase()+v[B+1].slice(1):v;if(h.isPlainObject(y[D])&&(B!=u)){y=y[D]}else{if(y[D]!==g){w=y[D];return false}else{if(h.isPlainObject(y[C])&&(B!=u)){y=y[C]}else{if(y[C]!==g){w=y[C];return false}else{F.error(H.method,v);return false}}}}})}if(h.isFunction(w)){A=w.apply(x,z)}else{if(w!==g){A=w}}if(h.isArray(r)){r.push(A)}else{if(r!==g){r=[r,A]}else{if(A!==g){r=A}}}return w}};if(t){if(i===g){F.initialize()}F.invoke(o)}else{if(i!==g){i.invoke("destroy")}F.initialize()}});return(r!==g)?r:this};h.fn.video.settings={name:"Video",namespace:"video",debug:false,verbose:false,performance:true,metadata:{id:"id",image:"image",source:"source",url:"url"},source:false,url:false,id:false,aspectRatio:(16/9),onPlay:function(){},onReset:function(){},onChange:function(){},onPause:function(){},onStop:function(){},width:"auto",height:"auto",autoplay:"auto",color:"#442359",hd:true,showUI:false,api:true,regExp:{youtube:/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,vimeo:/http:\/\/(www\.)?vimeo.com\/(\d+)($|\/)/},error:{noVideo:"No video specified",method:"The method you called is not defined"},className:{active:"active"},selector:{embed:".embed",placeholder:".placeholder",playButton:".play"}};h.fn.video.settings.templates={video:function(a){var b="";if(a){b+='<i class="video play icon"></i><img class="placeholder" src="'+a+'">'}b+='<div class="embed"></div>';return b}}})(jQuery,window,document);