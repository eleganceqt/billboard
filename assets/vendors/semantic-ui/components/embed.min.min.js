/*!
 * # Fomantic-UI - Embed
 * http://github.com/fomantic/Fomantic-UI/
 *
 *
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(h,e,f,g){h.isFunction=h.isFunction||function(a){return typeof a==="function"&&typeof a.nodeType!=="number"};e=(typeof e!="undefined"&&e.Math==Math)?e:(typeof self!="undefined"&&self.Math==Math)?self:Function("return this")();h.fn.embed=function(a){var c=h(this),o=c.selector||"",q=new Date().getTime(),d=[],n=arguments[0],r=(typeof n=="string"),b=[].slice.call(arguments,1),p;c.each(function(){var E=(h.isPlainObject(a))?h.extend(true,{},h.fn.embed.settings,a):h.extend({},h.fn.embed.settings),j=E.selector,K=E.className,H=E.sources,J=E.error,G=E.metadata,l=E.namespace,m=E.templates,i="."+l,O="module-"+l,I=h(this),L=I.find(j.placeholder),M=I.find(j.icon),N=I.find(j.embed),P=this,k=I.data(O),F;F={initialize:function(){F.debug("Initializing embed");F.determine.autoplay();F.create();F.bind.events();F.instantiate()},instantiate:function(){F.verbose("Storing instance of module",F);k=F;I.data(O,F)},destroy:function(){F.verbose("Destroying previous instance of embed");F.reset();I.removeData(O).off(i)},refresh:function(){F.verbose("Refreshing selector cache");L=I.find(j.placeholder);M=I.find(j.icon);N=I.find(j.embed)},bind:{events:function(){if(F.has.placeholder()){F.debug("Adding placeholder events");I.on("click"+i,j.placeholder,F.createAndShow).on("click"+i,j.icon,F.createAndShow)}}},create:function(){var s=F.get.placeholder();if(s){F.createPlaceholder()}else{F.createAndShow()}},createPlaceholder:function(t){var u=F.get.icon(),v=F.get.url(),s=F.generate.embed(v);t=t||F.get.placeholder();I.html(m.placeholder(t,u));F.debug("Creating placeholder for embed",t,u)},createEmbed:function(s){F.refresh();s=s||F.get.url();N=h("<div/>").addClass(K.embed).html(F.generate.embed(s)).appendTo(I);E.onCreate.call(P,s);F.debug("Creating embed object",N)},changeEmbed:function(s){N.html(F.generate.embed(s))},createAndShow:function(){F.createEmbed();F.show()},change:function(t,s,u){F.debug("Changing video to ",t,s,u);I.data(G.source,t).data(G.id,s);if(u){I.data(G.url,u)}else{I.removeData(G.url)}if(F.has.embed()){F.changeEmbed()}else{F.create()}},reset:function(){F.debug("Clearing embed and showing placeholder");F.remove.data();F.remove.active();F.remove.embed();F.showPlaceholder();E.onReset.call(P)},show:function(){F.debug("Showing embed");F.set.active();E.onDisplay.call(P)},hide:function(){F.debug("Hiding embed");F.showPlaceholder()},showPlaceholder:function(){F.debug("Showing placeholder image");F.remove.active();E.onPlaceholderDisplay.call(P)},get:{id:function(){return E.id||I.data(G.id)},placeholder:function(){return E.placeholder||I.data(G.placeholder)},icon:function(){return(E.icon)?E.icon:(I.data(G.icon)!==g)?I.data(G.icon):F.determine.icon()},source:function(s){return(E.source)?E.source:(I.data(G.source)!==g)?I.data(G.source):F.determine.source()},type:function(){var s=F.get.source();return(H[s]!==g)?H[s].type:false},url:function(){return(E.url)?E.url:(I.data(G.url)!==g)?I.data(G.url):F.determine.url()}},determine:{autoplay:function(){if(F.should.autoplay()){E.autoplay=true}},source:function(t){var s=false;t=t||F.get.url();if(t){h.each(H,function(v,u){if(t.search(u.domain)!==-1){s=v;return false}})}return s},icon:function(){var s=F.get.source();return(H[s]!==g)?H[s].icon:false},url:function(){var s=E.id||I.data(G.id),t=E.source||I.data(G.source),u;u=(H[t]!==g)?H[t].url.replace("{id}",s):false;if(u){I.data(G.url,u)}return u}},set:{active:function(){I.addClass(K.active)}},remove:{data:function(){I.removeData(G.id).removeData(G.icon).removeData(G.placeholder).removeData(G.source).removeData(G.url)},active:function(){I.removeClass(K.active)},embed:function(){N.empty()}},encode:{parameters:function(t){var s=[],u;for(u in t){s.push(encodeURIComponent(u)+"="+encodeURIComponent(t[u]))}return s.join("&amp;")}},generate:{embed:function(v){F.debug("Generating embed html");var s=F.get.source(),u,t;v=F.get.url(v);if(v){t=F.generate.parameters(s);u=m.iframe(v,t)}else{F.error(J.noURL,I)}return u},parameters:function(t,s){var u=(H[t]&&H[t].parameters!==g)?H[t].parameters(E):{};s=s||E.parameters;if(s){u=h.extend({},u,s)}u=E.onEmbed(u);return F.encode.parameters(u)}},has:{embed:function(){return(N.length>0)},placeholder:function(){return E.placeholder||I.data(G.placeholder)}},should:{autoplay:function(){return(E.autoplay==="auto")?(E.placeholder||I.data(G.placeholder)!==g):E.autoplay}},is:{video:function(){return F.get.type()=="video"}},setting:function(t,s){F.debug("Changing setting",t,s);if(h.isPlainObject(t)){h.extend(true,E,t)}else{if(s!==g){if(h.isPlainObject(E[t])){h.extend(true,E[t],s)}else{E[t]=s}}else{return E[t]}}},internal:function(t,s){if(h.isPlainObject(t)){h.extend(true,F,t)}else{if(s!==g){F[t]=s}else{return F[t]}}},debug:function(){if(!E.silent&&E.debug){if(E.performance){F.performance.log(arguments)}else{F.debug=Function.prototype.bind.call(console.info,console,E.name+":");F.debug.apply(console,arguments)}}},verbose:function(){if(!E.silent&&E.verbose&&E.debug){if(E.performance){F.performance.log(arguments)}else{F.verbose=Function.prototype.bind.call(console.info,console,E.name+":");F.verbose.apply(console,arguments)}}},error:function(){if(!E.silent){F.error=Function.prototype.bind.call(console.error,console,E.name+":");F.error.apply(console,arguments)}},performance:{log:function(t){var u,s,v;if(E.performance){u=new Date().getTime();v=q||u;s=u-v;q=u;d.push({Name:t[0],Arguments:[].slice.call(t,1)||"",Element:P,"Execution Time":s})}clearTimeout(F.performance.timer);F.performance.timer=setTimeout(F.performance.display,500)},display:function(){var s=E.name+":",t=0;q=false;clearTimeout(F.performance.timer);h.each(d,function(v,u){t+=u["Execution Time"]});s+=" "+t+"ms";if(o){s+=" '"+o+"'"}if(c.length>1){s+=" ("+c.length+")"}if((console.group!==g||console.table!==g)&&d.length>0){console.groupCollapsed(s);if(console.table){console.table(d)}else{h.each(d,function(v,u){console.log(u.Name+": "+u["Execution Time"]+"ms")})}console.groupEnd()}d=[]}},invoke:function(t,x,v){var w=k,s,u,y;x=x||b;v=P||v;if(typeof t=="string"&&w!==g){t=t.split(/[\. ]/);s=t.length-1;h.each(t,function(A,B){var z=(A!=s)?B+t[A+1].charAt(0).toUpperCase()+t[A+1].slice(1):t;if(h.isPlainObject(w[z])&&(A!=s)){w=w[z]}else{if(w[z]!==g){u=w[z];return false}else{if(h.isPlainObject(w[B])&&(A!=s)){w=w[B]}else{if(w[B]!==g){u=w[B];return false}else{F.error(J.method,t);return false}}}}})}if(h.isFunction(u)){y=u.apply(v,x)}else{if(u!==g){y=u}}if(Array.isArray(p)){p.push(y)}else{if(p!==g){p=[p,y]}else{if(y!==g){p=y}}}return u}};if(r){if(k===g){F.initialize()}F.invoke(n)}else{if(k!==g){k.invoke("destroy")}F.initialize()}});return(p!==g)?p:this};h.fn.embed.settings={name:"Embed",namespace:"embed",silent:false,debug:false,verbose:false,performance:true,icon:false,source:false,url:false,id:false,autoplay:"auto",color:"#444444",hd:true,brandedUI:false,parameters:false,onDisplay:function(){},onPlaceholderDisplay:function(){},onReset:function(){},onCreate:function(a){},onEmbed:function(a){return a},metadata:{id:"id",icon:"icon",placeholder:"placeholder",source:"source",url:"url"},error:{noURL:"No URL specified",method:"The method you called is not defined"},className:{active:"active",embed:"embed"},selector:{embed:".embed",placeholder:".placeholder",icon:".icon"},sources:{youtube:{name:"youtube",type:"video",icon:"video play",domain:"youtube.com",url:"//www.youtube.com/embed/{id}",parameters:function(a){return{autohide:!a.brandedUI,autoplay:a.autoplay,color:a.color||g,hq:a.hd,jsapi:a.api,modestbranding:!a.brandedUI}}},vimeo:{name:"vimeo",type:"video",icon:"video play",domain:"vimeo.com",url:"//player.vimeo.com/video/{id}",parameters:function(a){return{api:a.api,autoplay:a.autoplay,byline:a.brandedUI,color:a.color||g,portrait:a.brandedUI,title:a.brandedUI}}}},templates:{iframe:function(c,b){var a=c;if(b){a+="?"+b}return'<iframe src="'+a+'" width="100%" height="100%" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},placeholder:function(a,b){var c="";if(b){c+='<i class="'+b+' icon"></i>'}if(a){c+='<img class="placeholder" src="'+a+'">'}return c}},api:false,onPause:function(){},onPlay:function(){},onStop:function(){}}})(jQuery,window,document);