/*!
 * # Fomantic-UI - Rating
 * http://github.com/fomantic/Fomantic-UI/
 *
 *
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(c,b,a,d){c.isFunction=c.isFunction||function(e){return typeof e==="function"&&typeof e.nodeType!=="number"};b=(typeof b!="undefined"&&b.Math==Math)?b:(typeof self!="undefined"&&self.Math==Math)?self:Function("return this")();c.fn.rating=function(m){var k=c(this),h=k.selector||"",f=new Date().getTime(),j=[],i=arguments[0],e=(typeof i=="string"),l=[].slice.call(arguments,1),g;k.each(function(){var o=(c.isPlainObject(m))?c.extend(true,{},c.fn.rating.settings,m):c.extend({},c.fn.rating.settings),p=o.namespace,u=o.className,w=o.metadata,q=o.selector,z="."+p,s="module-"+p,r=this,y=c(this).data(s),v=c(this),t=v.find(q.icon),x,n;n={initialize:function(){n.verbose("Initializing rating module",o);if(t.length===0){n.setup.layout()}if(o.interactive&&!n.is.disabled()){n.enable()}else{n.disable()}n.set.initialLoad();n.set.rating(n.get.initialRating());n.remove.initialLoad();n.instantiate()},instantiate:function(){n.verbose("Instantiating module",o);y=n;v.data(s,n)},destroy:function(){n.verbose("Destroying previous instance",y);n.remove.events();v.removeData(s)},refresh:function(){t=v.find(q.icon)},setup:{layout:function(){var A=n.get.maxRating(),C=n.get.icon(),B=c.fn.rating.settings.templates.icon(A,C);n.debug("Generating icon html dynamically");v.html(B);n.refresh()}},event:{mouseenter:function(){var A=c(this);A.nextAll().removeClass(u.selected);v.addClass(u.selected);A.addClass(u.selected).prevAll().addClass(u.selected)},mouseleave:function(){v.removeClass(u.selected);t.removeClass(u.selected)},click:function(){var D=c(this),C=n.get.rating(),B=t.index(D)+1,A=(o.clearable=="auto")?(t.length===1):o.clearable;if(A&&C==B){n.clearRating()}else{n.set.rating(B)}}},clearRating:function(){n.debug("Clearing current rating");n.set.rating(0)},bind:{events:function(){n.verbose("Binding events");v.on("mouseenter"+z,q.icon,n.event.mouseenter).on("mouseleave"+z,q.icon,n.event.mouseleave).on("click"+z,q.icon,n.event.click)}},remove:{events:function(){n.verbose("Removing events");v.off(z)},initialLoad:function(){x=false}},enable:function(){n.debug("Setting rating to interactive mode");n.bind.events();v.removeClass(u.disabled)},disable:function(){n.debug("Setting rating to read-only mode");n.remove.events();v.addClass(u.disabled)},is:{initialLoad:function(){return x},disabled:function(){return v.hasClass(u.disabled)}},get:{icon:function(){var A=v.data(w.icon);if(A){v.removeData(w.icon)}return A||o.icon},initialRating:function(){if(v.data(w.rating)!==d){v.removeData(w.rating);return v.data(w.rating)}return o.initialRating},maxRating:function(){if(v.data(w.maxRating)!==d){v.removeData(w.maxRating);return v.data(w.maxRating)}return o.maxRating},rating:function(){var A=t.filter("."+u.active).length;n.verbose("Current rating retrieved",A);return A}},set:{rating:function(A){var C=(A-1>=0)?(A-1):0,B=t.eq(C);v.removeClass(u.selected);t.removeClass(u.selected).removeClass(u.active);if(A>0){n.verbose("Setting current rating to",A);B.prevAll().addBack().addClass(u.active)}if(!n.is.initialLoad()){o.onRate.call(r,A)}},initialLoad:function(){x=true}},setting:function(A,B){n.debug("Changing setting",A,B);if(c.isPlainObject(A)){c.extend(true,o,A)}else{if(B!==d){if(c.isPlainObject(o[A])){c.extend(true,o[A],B)}else{o[A]=B}}else{return o[A]}}},internal:function(A,B){if(c.isPlainObject(A)){c.extend(true,n,A)}else{if(B!==d){n[A]=B}else{return n[A]}}},debug:function(){if(!o.silent&&o.debug){if(o.performance){n.performance.log(arguments)}else{n.debug=Function.prototype.bind.call(console.info,console,o.name+":");n.debug.apply(console,arguments)}}},verbose:function(){if(!o.silent&&o.verbose&&o.debug){if(o.performance){n.performance.log(arguments)}else{n.verbose=Function.prototype.bind.call(console.info,console,o.name+":");n.verbose.apply(console,arguments)}}},error:function(){if(!o.silent){n.error=Function.prototype.bind.call(console.error,console,o.name+":");n.error.apply(console,arguments)}},performance:{log:function(C){var B,D,A;if(o.performance){B=new Date().getTime();A=f||B;D=B-A;f=B;j.push({Name:C[0],Arguments:[].slice.call(C,1)||"",Element:r,"Execution Time":D})}clearTimeout(n.performance.timer);n.performance.timer=setTimeout(n.performance.display,500)},display:function(){var B=o.name+":",A=0;f=false;clearTimeout(n.performance.timer);c.each(j,function(C,D){A+=D["Execution Time"]});B+=" "+A+"ms";if(h){B+=" '"+h+"'"}if(k.length>1){B+=" ("+k.length+")"}if((console.group!==d||console.table!==d)&&j.length>0){console.groupCollapsed(B);if(console.table){console.table(j)}else{c.each(j,function(C,D){console.log(D.Name+": "+D["Execution Time"]+"ms")})}console.groupEnd()}j=[]}},invoke:function(F,B,D){var C=y,G,E,A;B=B||l;D=r||D;if(typeof F=="string"&&C!==d){F=F.split(/[\. ]/);G=F.length-1;c.each(F,function(J,I){var H=(J!=G)?I+F[J+1].charAt(0).toUpperCase()+F[J+1].slice(1):F;if(c.isPlainObject(C[H])&&(J!=G)){C=C[H]}else{if(C[H]!==d){E=C[H];return false}else{if(c.isPlainObject(C[I])&&(J!=G)){C=C[I]}else{if(C[I]!==d){E=C[I];return false}else{return false}}}}})}if(c.isFunction(E)){A=E.apply(D,B)}else{if(E!==d){A=E}}if(Array.isArray(g)){g.push(A)}else{if(g!==d){g=[g,A]}else{if(A!==d){g=A}}}return E}};if(e){if(y===d){n.initialize()}n.invoke(i)}else{if(y!==d){y.invoke("destroy")}n.initialize()}});return(g!==d)?g:this};c.fn.rating.settings={name:"Rating",namespace:"rating",icon:"star",silent:false,debug:false,verbose:false,performance:true,initialRating:0,interactive:true,maxRating:4,clearable:"auto",fireOnInit:false,onRate:function(e){},error:{method:"The method you called is not defined",noMaximum:"No maximum rating specified. Cannot generate HTML automatically"},metadata:{rating:"rating",maxRating:"maxRating",icon:"icon"},className:{active:"active",disabled:"disabled",selected:"selected",loading:"loading"},selector:{icon:".icon"},templates:{icon:function(f,e){var h=1,g="";while(h<=f){g+='<i class="'+e+' icon"></i>';h++}return g}}}})(jQuery,window,document);