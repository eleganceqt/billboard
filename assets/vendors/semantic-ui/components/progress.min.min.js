/*!
 * # Fomantic-UI - Progress
 * http://github.com/fomantic/Fomantic-UI/
 *
 *
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(h,e,f,g){h.isFunction=h.isFunction||function(a){return typeof a==="function"&&typeof a.nodeType!=="number"};e=(typeof e!="undefined"&&e.Math==Math)?e:(typeof self!="undefined"&&self.Math==Math)?self:Function("return this")();h.fn.progress=function(a){var c=h(this),o=c.selector||"",q=new Date().getTime(),d=[],n=arguments[0],r=(typeof n=="string"),b=[].slice.call(arguments,1),p;c.each(function(){var E=(h.isPlainObject(a))?h.extend(true,{},h.fn.progress.settings,a):h.extend({},h.fn.progress.settings),N=E.className,I=E.metadata,l=E.namespace,j=E.selector,M=E.error,k="."+l,O="module-"+l,J=h(this),K=h(this).find(j.bar),G=h(this).find(j.progress),L=h(this).find(j.label),P=this,m=J.data(O),i=false,H,F;F={helper:{sum:function(s){return Array.isArray(s)?s.reduce(function(t,u){return t+Number(u)},0):0},derivePrecision:function(v,s){var t=0;var w=1;var u=v/s;while(t<10){u=u*w;if(u>1){break}w=Math.pow(10,t++)}return w},forceArray:function(s){return Array.isArray(s)?s:!isNaN(s)?[s]:typeof s=="string"?s.split(","):[]}},initialize:function(){F.set.duration();F.set.transitionEvent();F.debug(P);F.read.metadata();F.read.settings();F.instantiate()},instantiate:function(){F.verbose("Storing instance of progress",F);m=F;J.data(O,F)},destroy:function(){F.verbose("Destroying previous progress for",J);clearInterval(m.interval);F.remove.state();J.removeData(O);m=g},reset:function(){F.remove.nextValue();F.update.progress(0)},complete:function(){if(F.percent===g||F.percent<100){F.remove.progressPoll();F.set.percent(100)}},read:{metadata:function(){var s={percent:F.helper.forceArray(J.data(I.percent)),total:J.data(I.total),value:F.helper.forceArray(J.data(I.value))};if(s.total){F.debug("Total value set from metadata",s.total);F.set.total(s.total)}if(s.value.length>0){F.debug("Current value set from metadata",s.value);F.set.value(s.value);F.set.progress(s.value)}if(s.percent.length>0){F.debug("Current percent value set from metadata",s.percent);F.set.percent(s.percent)}},settings:function(){if(E.total!==false){F.debug("Current total set in settings",E.total);F.set.total(E.total)}if(E.value!==false){F.debug("Current value set in settings",E.value);F.set.value(E.value);F.set.progress(F.value)}if(E.percent!==false){F.debug("Current percent set in settings",E.percent);F.set.percent(E.percent)}}},bind:{transitionEnd:function(s){var t=F.get.transitionEnd();K.one(t+k,function(u){clearTimeout(F.failSafeTimer);s.call(this,u)});F.failSafeTimer=setTimeout(function(){K.triggerHandler(t)},E.duration+E.failSafeDelay);F.verbose("Adding fail safe timer",F.timer)}},increment:function(t){var u,s;if(F.has.total()){u=F.get.value();t=t||1}else{u=F.get.percent();t=t||F.get.randomValue()}s=u+t;F.debug("Incrementing percentage by",u,s,t);s=F.get.normalizedValue(s);F.set.progress(s)},decrement:function(u){var t=F.get.total(),v,s;if(t){v=F.get.value();u=u||1;s=v-u;F.debug("Decrementing value by",u,v)}else{v=F.get.percent();u=u||F.get.randomValue();s=v-u;F.debug("Decrementing percentage by",u,v)}s=F.get.normalizedValue(s);F.set.progress(s)},has:{progressPoll:function(){return F.progressPoll},total:function(){return(F.get.total()!==false)}},get:{text:function(u,y){var s=y||0,v=F.get.value(s),w=F.total||0,x=(i)?F.get.displayPercent(s):F.get.percent(s),t=(F.total>0)?(w-v):(100-x);u=u||"";u=u.replace("{value}",v).replace("{total}",w).replace("{left}",t).replace("{percent}",x).replace("{bar}",E.text.bars[s]||"");F.verbose("Adding variables to progress bar text",u);return u},normalizedValue:function(s){if(s<0){F.debug("Value cannot decrement below 0");return 0}if(F.has.total()){if(s>F.total){F.debug("Value cannot increment above total",F.total);return F.total}}else{if(s>100){F.debug("Value cannot increment above 100 percent");return 100}}return s},updateInterval:function(){if(E.updateInterval=="auto"){return E.duration}return E.updateInterval},randomValue:function(){F.debug("Generating random increment percentage");return Math.floor((Math.random()*E.random.max)+E.random.min)},numericValue:function(s){return(typeof s==="string")?(s.replace(/[^\d.]/g,"")!=="")?+(s.replace(/[^\d.]/g,"")):false:s},transitionEnd:function(){var u=f.createElement("element"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},s;for(s in t){if(u.style[s]!==g){return t[s]}}},displayPercent:function(v){var s=h(K[v]),t=s.width(),x=J.width(),u=parseInt(s.css("min-width"),10),w=(t>u)?(t/x*100):F.percent;return(E.precision>0)?Math.round(w*(10*E.precision))/(10*E.precision):Math.round(w)},percent:function(s){return F.percent&&F.percent[s||0]||0},value:function(s){return F.nextValue||F.value&&F.value[s||0]||0},total:function(){return F.total||false}},create:{progressPoll:function(){F.progressPoll=setTimeout(function(){F.update.toNextValue();F.remove.progressPoll()},F.get.updateInterval())}},is:{complete:function(){return F.is.success()||F.is.warning()||F.is.error()},success:function(){return J.hasClass(N.success)},warning:function(){return J.hasClass(N.warning)},error:function(){return J.hasClass(N.error)},active:function(){return J.hasClass(N.active)},visible:function(){return J.is(":visible")}},remove:{progressPoll:function(){F.verbose("Removing progress poll timer");if(F.progressPoll){clearTimeout(F.progressPoll);delete F.progressPoll}},nextValue:function(){F.verbose("Removing progress value stored for next update");delete F.nextValue},state:function(){F.verbose("Removing stored state");delete F.total;delete F.percent;delete F.value},active:function(){F.verbose("Removing active state");J.removeClass(N.active)},success:function(){F.verbose("Removing success state");J.removeClass(N.success)},warning:function(){F.verbose("Removing warning state");J.removeClass(N.warning)},error:function(){F.verbose("Removing error state");J.removeClass(N.error)}},set:{barWidth:function(v){F.debug("set bar width with ",v);v=F.helper.forceArray(v);var s=-1;var x=-1;var u=F.helper.sum(v);var w=K.length;var t=w>1;var y=v.map(function(B,z){var C=(z===w-1&&u===0);var A=h(K[z]);if(B===0&&t&&!C){A.css("display","none")}else{if(t&&C){A.css("background","transparent")}if(s==-1){s=z}x=z;A.css({display:"block",width:B+"%"})}return parseInt(B,10)});v.forEach(function(B,z){var A=h(K[z]);A.css({borderTopLeftRadius:z==s?"":0,borderBottomLeftRadius:z==s?"":0,borderTopRightRadius:z==x?"":0,borderBottomRightRadius:z==x?"":0})});J.attr("data-percent",y)},duration:function(s){s=s||E.duration;s=(typeof s=="number")?s+"ms":s;F.verbose("Setting progress bar transition duration",s);K.css({"transition-duration":s})},percent:function(x){x=F.helper.forceArray(x).map(function(y){return(typeof y=="string")?+(y.replace("%","")):y});var u=F.has.total();var w=F.helper.sum(x);var v=x.length>1&&u;var s=F.helper.sum(F.helper.forceArray(F.value));if(v&&s>F.total){F.error(M.sumExceedsTotal,s,F.total)}else{if(!v&&w>100){F.error(M.tooHigh,w)}else{if(w<0){F.error(M.tooLow,w)}else{var t=E.precision>0?E.precision:v?F.helper.derivePrecision(Math.min.apply(null,F.value),F.total):g;x=x.map(function(y){return(t>0)?Math.round(y*(10*t))/(10*t):Math.round(y)});F.percent=x;if(!u){F.value=x.map(function(y){return(t>0)?Math.round((y/100)*F.total*(10*t))/(10*t):Math.round((y/100)*F.total*10)/10});if(E.limitValues){F.value=F.value.map(function(y){return(y>100)?100:(F.value<0)?0:F.value})}}F.set.barWidth(x);F.set.labelInterval();F.set.labels()}}}E.onChange.call(P,x,F.value,F.total)},labelInterval:function(){var s=function(){F.verbose("Bar finished animating, removing continuous label updates");clearInterval(F.interval);i=false;F.set.labels()};clearInterval(F.interval);F.bind.transitionEnd(s);i=true;F.interval=setInterval(function(){var t=h.contains(f.documentElement,P);if(!t){clearInterval(F.interval);i=false}F.set.labels()},E.framerate)},labels:function(){F.verbose("Setting both bar progress and outer label text");F.set.barLabel();F.set.state()},label:function(s){s=s||"";if(s){s=F.get.text(s);F.verbose("Setting label to text",s);L.text(s)}},state:function(s){s=(s!==g)?s:F.helper.sum(F.percent);if(s===100){if(E.autoSuccess&&K.length===1&&!(F.is.warning()||F.is.error()||F.is.success())){F.set.success();F.debug("Automatically triggering success at 100%")}else{F.verbose("Reached 100% removing active state");F.remove.active();F.remove.progressPoll()}}else{if(s>0){F.verbose("Adjusting active progress bar label",s);F.set.active()}else{F.remove.active();F.set.label(E.text.active)}}},barLabel:function(s){G.map(function(u,t){var v=h(t);if(s!==g){v.text(F.get.text(s,u))}else{if(E.label=="ratio"&&F.total){F.verbose("Adding ratio to bar label");v.text(F.get.text(E.text.ratio,u))}else{if(E.label=="percent"){F.verbose("Adding percentage to bar label");v.text(F.get.text(E.text.percent,u))}}}})},active:function(s){s=s||E.text.active;F.debug("Setting active state");if(E.showActivity&&!F.is.active()){J.addClass(N.active)}F.remove.warning();F.remove.error();F.remove.success();s=E.onLabelUpdate("active",s,F.value,F.total);if(s){F.set.label(s)}F.bind.transitionEnd(function(){E.onActive.call(P,F.value,F.total)})},success:function(s){s=s||E.text.success||E.text.active;F.debug("Setting success state");J.addClass(N.success);F.remove.active();F.remove.warning();F.remove.error();F.complete();if(E.text.success){s=E.onLabelUpdate("success",s,F.value,F.total);F.set.label(s)}else{s=E.onLabelUpdate("active",s,F.value,F.total);F.set.label(s)}F.bind.transitionEnd(function(){E.onSuccess.call(P,F.total)})},warning:function(s){s=s||E.text.warning;F.debug("Setting warning state");J.addClass(N.warning);F.remove.active();F.remove.success();F.remove.error();F.complete();s=E.onLabelUpdate("warning",s,F.value,F.total);if(s){F.set.label(s)}F.bind.transitionEnd(function(){E.onWarning.call(P,F.value,F.total)})},error:function(s){s=s||E.text.error;F.debug("Setting error state");J.addClass(N.error);F.remove.active();F.remove.success();F.remove.warning();F.complete();s=E.onLabelUpdate("error",s,F.value,F.total);if(s){F.set.label(s)}F.bind.transitionEnd(function(){E.onError.call(P,F.value,F.total)})},transitionEvent:function(){H=F.get.transitionEnd()},total:function(s){F.total=s},value:function(s){F.value=F.helper.forceArray(s)},progress:function(s){if(!F.has.progressPoll()){F.debug("First update in progress update interval, immediately updating",s);F.update.progress(s);F.create.progressPoll()}else{F.debug("Updated within interval, setting next update to use new value",s);F.set.nextValue(s)}},nextValue:function(s){F.nextValue=s}},update:{toNextValue:function(){var s=F.nextValue;if(s){F.debug("Update interval complete using last updated value",s);F.update.progress(s);F.remove.nextValue()}},progress:function(u){var t=F.has.total();if(t){F.set.value(u)}var s=F.helper.forceArray(u).map(function(v){var w;v=F.get.numericValue(v);if(v===false){F.error(M.nonNumeric,v)}v=F.get.normalizedValue(v);if(t){w=(v/F.total)*100;F.debug("Calculating percent complete from total",w)}else{w=v;F.debug("Setting value to exact percentage value",w)}return w});F.set.percent(s)}},setting:function(t,s){F.debug("Changing setting",t,s);if(h.isPlainObject(t)){h.extend(true,E,t)}else{if(s!==g){if(h.isPlainObject(E[t])){h.extend(true,E[t],s)}else{E[t]=s}}else{return E[t]}}},internal:function(t,s){if(h.isPlainObject(t)){h.extend(true,F,t)}else{if(s!==g){F[t]=s}else{return F[t]}}},debug:function(){if(!E.silent&&E.debug){if(E.performance){F.performance.log(arguments)}else{F.debug=Function.prototype.bind.call(console.info,console,E.name+":");F.debug.apply(console,arguments)}}},verbose:function(){if(!E.silent&&E.verbose&&E.debug){if(E.performance){F.performance.log(arguments)}else{F.verbose=Function.prototype.bind.call(console.info,console,E.name+":");F.verbose.apply(console,arguments)}}},error:function(){if(!E.silent){F.error=Function.prototype.bind.call(console.error,console,E.name+":");F.error.apply(console,arguments)}},performance:{log:function(t){var u,s,v;if(E.performance){u=new Date().getTime();v=q||u;s=u-v;q=u;d.push({Name:t[0],Arguments:[].slice.call(t,1)||"",Element:P,"Execution Time":s})}clearTimeout(F.performance.timer);F.performance.timer=setTimeout(F.performance.display,500)},display:function(){var s=E.name+":",t=0;q=false;clearTimeout(F.performance.timer);h.each(d,function(v,u){t+=u["Execution Time"]});s+=" "+t+"ms";if(o){s+=" '"+o+"'"}if((console.group!==g||console.table!==g)&&d.length>0){console.groupCollapsed(s);if(console.table){console.table(d)}else{h.each(d,function(v,u){console.log(u.Name+": "+u["Execution Time"]+"ms")})}console.groupEnd()}d=[]}},invoke:function(t,x,v){var w=m,s,u,y;x=x||b;v=P||v;if(typeof t=="string"&&w!==g){t=t.split(/[\. ]/);s=t.length-1;h.each(t,function(A,B){var z=(A!=s)?B+t[A+1].charAt(0).toUpperCase()+t[A+1].slice(1):t;if(h.isPlainObject(w[z])&&(A!=s)){w=w[z]}else{if(w[z]!==g){u=w[z];return false}else{if(h.isPlainObject(w[B])&&(A!=s)){w=w[B]}else{if(w[B]!==g){u=w[B];return false}else{F.error(M.method,t);return false}}}}})}if(h.isFunction(u)){y=u.apply(v,x)}else{if(u!==g){y=u}}if(Array.isArray(p)){p.push(y)}else{if(p!==g){p=[p,y]}else{if(y!==g){p=y}}}return u}};if(r){if(m===g){F.initialize()}F.invoke(n)}else{if(m!==g){m.invoke("destroy")}F.initialize()}});return(p!==g)?p:this};h.fn.progress.settings={name:"Progress",namespace:"progress",silent:false,debug:false,verbose:false,performance:true,random:{min:2,max:5},duration:300,updateInterval:"auto",autoSuccess:true,showActivity:true,limitValues:true,label:"percent",precision:0,framerate:(1000/30),percent:false,total:false,value:false,failSafeDelay:100,onLabelUpdate:function(b,a,c,d){return a},onChange:function(b,a,c){},onSuccess:function(a){},onActive:function(a,b){},onError:function(a,b){},onWarning:function(a,b){},error:{method:"The method you called is not defined.",nonNumeric:"Progress value is non numeric",tooHigh:"Value specified is above 100%",tooLow:"Value specified is below 0%",sumExceedsTotal:"Sum of multple values exceed total"},regExp:{variable:/\{\$*[A-z0-9]+\}/g},metadata:{percent:"percent",total:"total",value:"value"},selector:{bar:"> .bar",label:"> .label",progress:".bar > .progress"},text:{active:false,error:false,success:false,warning:false,percent:"{percent}%",ratio:"{value} of {total}",bars:[""]},className:{active:"active",error:"error",success:"success",warning:"warning"}}})(jQuery,window,document);