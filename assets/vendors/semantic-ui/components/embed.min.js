/*!
 * # Fomantic-UI - Embed
 * http://github.com/fomantic/Fomantic-UI/
 *
 *
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(c,b,a,d){c.isFunction=c.isFunction||function(e){return typeof e==="function"&&typeof e.nodeType!=="number"};b=(typeof b!="undefined"&&b.Math==Math)?b:(typeof self!="undefined"&&self.Math==Math)?self:Function("return this")();c.fn.embed=function(m){var k=c(this),h=k.selector||"",f=new Date().getTime(),j=[],i=arguments[0],e=(typeof i=="string"),l=[].slice.call(arguments,1),g;k.each(function(){var p=(c.isPlainObject(m))?c.extend(true,{},c.fn.embed.settings,m):c.extend({},c.fn.embed.settings),r=p.selector,x=p.className,n=p.sources,y=p.error,A=p.metadata,q=p.namespace,B=p.templates,D="."+q,t="module-"+q,z=c(this),w=z.find(r.placeholder),v=z.find(r.icon),u=z.find(r.embed),s=this,C=z.data(t),o;o={initialize:function(){o.debug("Initializing embed");o.determine.autoplay();o.create();o.bind.events();o.instantiate()},instantiate:function(){o.verbose("Storing instance of module",o);C=o;z.data(t,o)},destroy:function(){o.verbose("Destroying previous instance of embed");o.reset();z.removeData(t).off(D)},refresh:function(){o.verbose("Refreshing selector cache");w=z.find(r.placeholder);v=z.find(r.icon);u=z.find(r.embed)},bind:{events:function(){if(o.has.placeholder()){o.debug("Adding placeholder events");z.on("click"+D,r.placeholder,o.createAndShow).on("click"+D,r.icon,o.createAndShow)}}},create:function(){var E=o.get.placeholder();if(E){o.createPlaceholder()}else{o.createAndShow()}},createPlaceholder:function(G){var F=o.get.icon(),E=o.get.url(),H=o.generate.embed(E);G=G||o.get.placeholder();z.html(B.placeholder(G,F));o.debug("Creating placeholder for embed",G,F)},createEmbed:function(E){o.refresh();E=E||o.get.url();u=c("<div/>").addClass(x.embed).html(o.generate.embed(E)).appendTo(z);p.onCreate.call(s,E);o.debug("Creating embed object",u)},changeEmbed:function(E){u.html(o.generate.embed(E))},createAndShow:function(){o.createEmbed();o.show()},change:function(F,G,E){o.debug("Changing video to ",F,G,E);z.data(A.source,F).data(A.id,G);if(E){z.data(A.url,E)}else{z.removeData(A.url)}if(o.has.embed()){o.changeEmbed()}else{o.create()}},reset:function(){o.debug("Clearing embed and showing placeholder");o.remove.data();o.remove.active();o.remove.embed();o.showPlaceholder();p.onReset.call(s)},show:function(){o.debug("Showing embed");o.set.active();p.onDisplay.call(s)},hide:function(){o.debug("Hiding embed");o.showPlaceholder()},showPlaceholder:function(){o.debug("Showing placeholder image");o.remove.active();p.onPlaceholderDisplay.call(s)},get:{id:function(){return p.id||z.data(A.id)},placeholder:function(){return p.placeholder||z.data(A.placeholder)},icon:function(){return(p.icon)?p.icon:(z.data(A.icon)!==d)?z.data(A.icon):o.determine.icon()},source:function(E){return(p.source)?p.source:(z.data(A.source)!==d)?z.data(A.source):o.determine.source()},type:function(){var E=o.get.source();return(n[E]!==d)?n[E].type:false},url:function(){return(p.url)?p.url:(z.data(A.url)!==d)?z.data(A.url):o.determine.url()}},determine:{autoplay:function(){if(o.should.autoplay()){p.autoplay=true}},source:function(E){var F=false;E=E||o.get.url();if(E){c.each(n,function(G,H){if(E.search(H.domain)!==-1){F=G;return false}})}return F},icon:function(){var E=o.get.source();return(n[E]!==d)?n[E].icon:false},url:function(){var G=p.id||z.data(A.id),F=p.source||z.data(A.source),E;E=(n[F]!==d)?n[F].url.replace("{id}",G):false;if(E){z.data(A.url,E)}return E}},set:{active:function(){z.addClass(x.active)}},remove:{data:function(){z.removeData(A.id).removeData(A.icon).removeData(A.placeholder).removeData(A.source).removeData(A.url)},active:function(){z.removeClass(x.active)},embed:function(){u.empty()}},encode:{parameters:function(F){var G=[],E;for(E in F){G.push(encodeURIComponent(E)+"="+encodeURIComponent(F[E]))}return G.join("&amp;")}},generate:{embed:function(E){o.debug("Generating embed html");var H=o.get.source(),F,G;E=o.get.url(E);if(E){G=o.generate.parameters(H);F=B.iframe(E,G)}else{o.error(y.noURL,z)}return F},parameters:function(F,G){var E=(n[F]&&n[F].parameters!==d)?n[F].parameters(p):{};G=G||p.parameters;if(G){E=c.extend({},E,G)}E=p.onEmbed(E);return o.encode.parameters(E)}},has:{embed:function(){return(u.length>0)},placeholder:function(){return p.placeholder||z.data(A.placeholder)}},should:{autoplay:function(){return(p.autoplay==="auto")?(p.placeholder||z.data(A.placeholder)!==d):p.autoplay}},is:{video:function(){return o.get.type()=="video"}},setting:function(E,F){o.debug("Changing setting",E,F);if(c.isPlainObject(E)){c.extend(true,p,E)}else{if(F!==d){if(c.isPlainObject(p[E])){c.extend(true,p[E],F)}else{p[E]=F}}else{return p[E]}}},internal:function(E,F){if(c.isPlainObject(E)){c.extend(true,o,E)}else{if(F!==d){o[E]=F}else{return o[E]}}},debug:function(){if(!p.silent&&p.debug){if(p.performance){o.performance.log(arguments)}else{o.debug=Function.prototype.bind.call(console.info,console,p.name+":");o.debug.apply(console,arguments)}}},verbose:function(){if(!p.silent&&p.verbose&&p.debug){if(p.performance){o.performance.log(arguments)}else{o.verbose=Function.prototype.bind.call(console.info,console,p.name+":");o.verbose.apply(console,arguments)}}},error:function(){if(!p.silent){o.error=Function.prototype.bind.call(console.error,console,p.name+":");o.error.apply(console,arguments)}},performance:{log:function(G){var F,H,E;if(p.performance){F=new Date().getTime();E=f||F;H=F-E;f=F;j.push({Name:G[0],Arguments:[].slice.call(G,1)||"",Element:s,"Execution Time":H})}clearTimeout(o.performance.timer);o.performance.timer=setTimeout(o.performance.display,500)},display:function(){var F=p.name+":",E=0;f=false;clearTimeout(o.performance.timer);c.each(j,function(G,H){E+=H["Execution Time"]});F+=" "+E+"ms";if(h){F+=" '"+h+"'"}if(k.length>1){F+=" ("+k.length+")"}if((console.group!==d||console.table!==d)&&j.length>0){console.groupCollapsed(F);if(console.table){console.table(j)}else{c.each(j,function(G,H){console.log(H.Name+": "+H["Execution Time"]+"ms")})}console.groupEnd()}j=[]}},invoke:function(J,F,H){var G=C,K,I,E;F=F||l;H=s||H;if(typeof J=="string"&&G!==d){J=J.split(/[\. ]/);K=J.length-1;c.each(J,function(N,M){var L=(N!=K)?M+J[N+1].charAt(0).toUpperCase()+J[N+1].slice(1):J;if(c.isPlainObject(G[L])&&(N!=K)){G=G[L]}else{if(G[L]!==d){I=G[L];return false}else{if(c.isPlainObject(G[M])&&(N!=K)){G=G[M]}else{if(G[M]!==d){I=G[M];return false}else{o.error(y.method,J);return false}}}}})}if(c.isFunction(I)){E=I.apply(H,F)}else{if(I!==d){E=I}}if(Array.isArray(g)){g.push(E)}else{if(g!==d){g=[g,E]}else{if(E!==d){g=E}}}return I}};if(e){if(C===d){o.initialize()}o.invoke(i)}else{if(C!==d){C.invoke("destroy")}o.initialize()}});return(g!==d)?g:this};c.fn.embed.settings={name:"Embed",namespace:"embed",silent:false,debug:false,verbose:false,performance:true,icon:false,source:false,url:false,id:false,autoplay:"auto",color:"#444444",hd:true,brandedUI:false,parameters:false,onDisplay:function(){},onPlaceholderDisplay:function(){},onReset:function(){},onCreate:function(e){},onEmbed:function(e){return e},metadata:{id:"id",icon:"icon",placeholder:"placeholder",source:"source",url:"url"},error:{noURL:"No URL specified",method:"The method you called is not defined"},className:{active:"active",embed:"embed"},selector:{embed:".embed",placeholder:".placeholder",icon:".icon"},sources:{youtube:{name:"youtube",type:"video",icon:"video play",domain:"youtube.com",url:"//www.youtube.com/embed/{id}",parameters:function(e){return{autohide:!e.brandedUI,autoplay:e.autoplay,color:e.color||d,hq:e.hd,jsapi:e.api,modestbranding:!e.brandedUI}}},vimeo:{name:"vimeo",type:"video",icon:"video play",domain:"vimeo.com",url:"//player.vimeo.com/video/{id}",parameters:function(e){return{api:e.api,autoplay:e.autoplay,byline:e.brandedUI,color:e.color||d,portrait:e.brandedUI,title:e.brandedUI}}}},templates:{iframe:function(e,f){var g=e;if(f){g+="?"+f}return'<iframe src="'+g+'" width="100%" height="100%" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},placeholder:function(g,f){var e="";if(f){e+='<i class="'+f+' icon"></i>'}if(g){e+='<img class="placeholder" src="'+g+'">'}return e}},api:false,onPause:function(){},onPlay:function(){},onStop:function(){}}})(jQuery,window,document);