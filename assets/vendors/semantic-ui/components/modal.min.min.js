/*!
 * # Fomantic-UI - Modal
 * http://github.com/fomantic/Fomantic-UI/
 *
 *
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(h,e,f,g){h.isFunction=h.isFunction||function(a){return typeof a==="function"&&typeof a.nodeType!=="number"};e=(typeof e!="undefined"&&e.Math==Math)?e:(typeof self!="undefined"&&self.Math==Math)?self:Function("return this")();h.fn.modal=function(a){var c=h(this),y=h(e),v=h(f),u=h("body"),s=c.selector||"",x=new Date().getTime(),d=[],r=arguments[0],z=(typeof r=="string"),b=[].slice.call(arguments,1),t=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||e.msRequestAnimationFrame||function(i){setTimeout(i,0)},w;c.each(function(){var l=(h.isPlainObject(a))?h.extend(true,{},h.fn.modal.settings,a):h.extend({},h.fn.modal.settings),m=l.selector,X=l.className,ae=l.namespace,p=l.error,U="."+ae,ad="module-"+ae,T=h(this),W=h(l.context),V=T.find(m.close),i,af,R,q,S,Z=this,k=T.data(ad),ac=false,o,ab,Q="",j,Y,n,aa;aa={initialize:function(){aa.verbose("Initializing dimmer",W);aa.create.id();aa.create.dimmer();if(l.allowMultiple){aa.create.innerDimmer()}if(!l.centered){T.addClass("top aligned")}aa.refreshModals();aa.bind.events();if(l.observeChanges){aa.observeChanges()}aa.instantiate()},instantiate:function(){aa.verbose("Storing instance of modal");k=aa;T.data(ad,k)},create:{dimmer:function(){var B={debug:l.debug,dimmerName:"modals"},A=h.extend(true,B,l.dimmerSettings);if(h.fn.dimmer===g){aa.error(p.dimmer);return}aa.debug("Creating dimmer");q=W.dimmer(A);if(l.detachable){aa.verbose("Modal is detachable, moving content into dimmer");q.dimmer("add content",T)}else{aa.set.undetached()}S=q.dimmer("get dimmer")},id:function(){Y=(Math.random().toString(16)+"000000000").substr(2,8);j="."+Y;aa.verbose("Creating unique id for element",Y)},innerDimmer:function(){if(T.find(m.dimmer).length==0){T.prepend('<div class="ui inverted dimmer"></div>')}}},destroy:function(){if(n){n.disconnect()}aa.verbose("Destroying previous modal");T.removeData(ad).off(U);y.off(j);S.off(j);V.off(U);W.dimmer("destroy")},observeChanges:function(){if("MutationObserver" in e){n=new MutationObserver(function(A){aa.debug("DOM tree modified, refreshing");aa.refresh()});n.observe(Z,{childList:true,subtree:true});aa.debug("Setting up mutation observer",n)}},refresh:function(){aa.remove.scrolling();aa.cacheSizes();if(!aa.can.useFlex()){aa.set.modalOffset()}aa.set.screenHeight();aa.set.type()},refreshModals:function(){af=T.siblings(m.modal);i=af.add(T)},attachEvents:function(C,A){var B=h(C);A=h.isFunction(aa[A])?aa[A]:aa.toggle;if(B.length>0){aa.debug("Attaching modal events to element",C,A);B.off(U).on("click"+U,A)}else{aa.error(p.notFound,C)}},bind:{events:function(){aa.verbose("Attaching events");T.on("click"+U,m.close,aa.event.close).on("click"+U,m.approve,aa.event.approve).on("click"+U,m.deny,aa.event.deny);y.on("resize"+j,aa.event.resize)},scrollLock:function(){q.get(0).addEventListener("touchmove",aa.event.preventScroll,{passive:false})}},unbind:{scrollLock:function(){q.get(0).removeEventListener("touchmove",aa.event.preventScroll,{passive:false})}},get:{id:function(){return(Math.random().toString(16)+"000000000").substr(2,8)}},event:{approve:function(){if(ac||l.onApprove.call(Z,h(this))===false){aa.verbose("Approve callback returned false cancelling hide");return}ac=true;aa.hide(function(){ac=false})},preventScroll:function(A){if(A.target.className.indexOf("dimmer")!==-1){A.preventDefault()}},deny:function(){if(ac||l.onDeny.call(Z,h(this))===false){aa.verbose("Deny callback returned false cancelling hide");return}ac=true;aa.hide(function(){ac=false})},close:function(){aa.hide()},mousedown:function(A){var B=h(A.target);o=(B.closest(m.modal).length>0);if(o){aa.verbose("Mouse down event registered inside the modal")}ab=aa.is.scrolling()&&h(e).outerWidth()-l.scrollbarWidth<=A.clientX;if(ab){aa.verbose("Mouse down event registered inside the scrollbar")}},mouseup:function(A){if(!l.closable){aa.verbose("Dimmer clicked but closable setting is disabled");return}if(o){aa.debug("Dimmer clicked but mouse down was initially registered inside the modal");return}if(ab){aa.debug("Dimmer clicked but mouse down was initially registered inside the scrollbar");return}var C=h(A.target),B=(C.closest(m.modal).length>0),D=h.contains(f.documentElement,A.target);if(!B&&D&&aa.is.active()&&T.hasClass(X.front)){aa.debug("Dimmer clicked, hiding all modals");if(l.allowMultiple){if(!aa.hideAll()){return}}else{if(!aa.hide()){return}}aa.remove.clickaway()}},debounce:function(A,B){clearTimeout(aa.timer);aa.timer=setTimeout(A,B)},keyboard:function(B){var A=B.which,C=27;if(A==C){if(l.closable){aa.debug("Escape key pressed hiding modal");if(T.hasClass(X.front)){aa.hide()}}else{aa.debug("Escape key pressed, but closable is set to false")}B.preventDefault()}},resize:function(){if(q.dimmer("is active")&&(aa.is.animating()||aa.is.active())){t(aa.refresh)}}},toggle:function(){if(aa.is.active()||aa.is.animating()){aa.hide()}else{aa.show()}},show:function(A){A=h.isFunction(A)?A:function(){};aa.refreshModals();aa.set.dimmerSettings();aa.set.dimmerStyles();aa.showModal(A)},hide:function(A){A=h.isFunction(A)?A:function(){};aa.refreshModals();return aa.hideModal(A)},showModal:function(A){A=h.isFunction(A)?A:function(){};if(aa.is.animating()||!aa.is.active()){aa.showDimmer();aa.cacheSizes();if(aa.can.useFlex()){aa.remove.legacy()}else{aa.set.legacy();aa.set.modalOffset();aa.debug("Using non-flex legacy modal positioning.")}aa.set.screenHeight();aa.set.type();aa.set.clickaway();if(!l.allowMultiple&&aa.others.active()){aa.hideOthers(aa.showModal)}else{ac=false;if(l.allowMultiple){if(aa.others.active()){af.filter("."+X.active).find(m.dimmer).addClass("active")}if(l.detachable){T.detach().appendTo(S)}}l.onShow.call(Z);if(l.transition&&h.fn.transition!==g&&T.transition("is supported")){aa.debug("Showing modal with css animations");T.transition({debug:l.debug,animation:l.transition+" in",queue:l.queue,duration:l.duration,useFailSafe:true,onComplete:function(){l.onVisible.apply(Z);if(l.keyboardShortcuts){aa.add.keyboardShortcuts()}aa.save.focus();aa.set.active();if(l.autofocus){aa.set.autofocus()}A()}})}else{aa.error(p.noTransition)}}}else{aa.debug("Modal is already visible")}},hideModal:function(A,D,B){var C=af.filter("."+X.active).last();A=h.isFunction(A)?A:function(){};aa.debug("Hiding modal");if(l.onHide.call(Z,h(this))===false){aa.verbose("Hide callback returned false cancelling hide");ac=false;return false}if(aa.is.animating()||aa.is.active()){if(l.transition&&h.fn.transition!==g&&T.transition("is supported")){aa.remove.active();T.transition({debug:l.debug,animation:l.transition+" out",queue:l.queue,duration:l.duration,useFailSafe:true,onStart:function(){if(!aa.others.active()&&!aa.others.animating()&&!D){aa.hideDimmer()}if(l.keyboardShortcuts&&!aa.others.active()){aa.remove.keyboardShortcuts()}},onComplete:function(){aa.unbind.scrollLock();if(l.allowMultiple){C.addClass(X.front);T.removeClass(X.front);if(B){i.find(m.dimmer).removeClass("active")}else{C.find(m.dimmer).removeClass("active")}}l.onHidden.call(Z);aa.remove.dimmerStyles();aa.restore.focus();A()}})}else{aa.error(p.noTransition)}}},showDimmer:function(){if(q.dimmer("is animating")||!q.dimmer("is active")){aa.save.bodyMargin();aa.debug("Showing dimmer");q.dimmer("show")}else{aa.debug("Dimmer already visible")}},hideDimmer:function(){if(q.dimmer("is animating")||(q.dimmer("is active"))){aa.unbind.scrollLock();q.dimmer("hide",function(){aa.restore.bodyMargin();aa.remove.clickaway();aa.remove.screenHeight()})}else{aa.debug("Dimmer is not visible cannot hide");return}},hideAll:function(A){var B=i.filter("."+X.active+", ."+X.animating);A=h.isFunction(A)?A:function(){};if(B.length>0){aa.debug("Hiding all visible modals");var C=true;h(B.get().reverse()).each(function(E,D){if(C){C=h(D).modal("hide modal",A,false,true)}});if(C){aa.hideDimmer()}return C}},hideOthers:function(A){var B=af.filter("."+X.active+", ."+X.animating);A=h.isFunction(A)?A:function(){};if(B.length>0){aa.debug("Hiding other modals",af);B.modal("hide modal",A,true)}},others:{active:function(){return(af.filter("."+X.active).length>0)},animating:function(){return(af.filter("."+X.animating).length>0)}},add:{keyboardShortcuts:function(){aa.verbose("Adding keyboard shortcuts");v.on("keyup"+U,aa.event.keyboard)}},save:{focus:function(){var B=h(f.activeElement),A=B.closest(T).length>0;if(!A){R=h(f.activeElement).blur()}},bodyMargin:function(){Q=u.css("margin-right");var C=parseInt(Q.replace(/[^\d.]/g,"")),A=e.innerWidth-f.documentElement.clientWidth,B=C+A;u.css("margin-right",B+"px");u.find(m.bodyFixed).css("padding-right",B+"px")}},restore:{focus:function(){if(R&&R.length>0&&l.restoreFocus){R.focus()}},bodyMargin:function(){u.css("margin-right",Q);u.find(m.bodyFixed).css("padding-right",Q)}},remove:{active:function(){T.removeClass(X.active)},legacy:function(){T.removeClass(X.legacy)},clickaway:function(){S.off("mousedown"+j);S.off("mouseup"+j)},dimmerStyles:function(){S.removeClass(X.inverted);q.removeClass(X.blurring)},bodyStyle:function(){if(u.attr("style")===""){aa.verbose("Removing style attribute");u.removeAttr("style")}},screenHeight:function(){aa.debug("Removing page height");u.css("height","")},keyboardShortcuts:function(){aa.verbose("Removing keyboard shortcuts");v.off("keyup"+U)},scrolling:function(){q.removeClass(X.scrolling);T.removeClass(X.scrolling)}},cacheSizes:function(){T.addClass(X.loading);var A=T.prop("scrollHeight"),C=T.outerWidth(),B=T.outerHeight();if(aa.cache===g||B!==0){aa.cache={pageHeight:h(f).outerHeight(),width:C,height:B+l.offset,scrollHeight:A+l.offset,contextHeight:(l.context=="body")?h(e).height():q.height()};aa.cache.topOffset=-(aa.cache.height/2)}T.removeClass(X.loading);aa.debug("Caching modal and container sizes",aa.cache)},can:{useFlex:function(){return(l.useFlex=="auto")?l.detachable&&!aa.is.ie():l.useFlex},fit:function(){var F=aa.cache.contextHeight,D=aa.cache.contextHeight/2,E=aa.cache.topOffset,B=aa.cache.scrollHeight,G=aa.cache.height,A=l.padding,C=(D+E);return(B>G)?(C+B+A<F):(G+(A*2)<F)}},is:{active:function(){return T.hasClass(X.active)},ie:function(){var A=(!(e.ActiveXObject)&&"ActiveXObject" in e),B=("ActiveXObject" in e);return(A||B)},animating:function(){return T.transition("is supported")?T.transition("is animating"):T.is(":visible")},scrolling:function(){return q.hasClass(X.scrolling)},modernBrowser:function(){return !(e.ActiveXObject||"ActiveXObject" in e)}},set:{autofocus:function(){var C=T.find("[tabindex], :input").filter(":visible").filter(function(){return h(this).closest(".disabled").length===0}),B=C.filter("[autofocus]"),A=(B.length>0)?B.first():C.first();if(A.length>0){A.focus()}},clickaway:function(){S.on("mousedown"+j,aa.event.mousedown);S.on("mouseup"+j,aa.event.mouseup)},dimmerSettings:function(){if(h.fn.dimmer===g){aa.error(p.dimmer);return}var B={debug:l.debug,dimmerName:"modals",closable:"auto",useFlex:aa.can.useFlex(),duration:{show:l.duration,hide:l.duration}},A=h.extend(true,B,l.dimmerSettings);if(l.inverted){A.variation=(A.variation!==g)?A.variation+" inverted":"inverted"}W.dimmer("setting",A)},dimmerStyles:function(){if(l.inverted){S.addClass(X.inverted)}else{S.removeClass(X.inverted)}if(l.blurring){q.addClass(X.blurring)}else{q.removeClass(X.blurring)}},modalOffset:function(){var A=aa.cache.width,B=aa.cache.height;T.css({marginTop:(!T.hasClass("aligned")&&aa.can.fit())?-(B/2):0,marginLeft:-(A/2)});aa.verbose("Setting modal offset for legacy mode")},screenHeight:function(){if(aa.can.fit()){u.css("height","")}else{if(!T.hasClass("bottom")){aa.debug("Modal is taller than page content, resizing page height");u.css("height",aa.cache.height+(l.padding*2))}}},active:function(){T.addClass(X.active+" "+X.front);af.filter("."+X.active).removeClass(X.front)},scrolling:function(){q.addClass(X.scrolling);T.addClass(X.scrolling);aa.unbind.scrollLock()},legacy:function(){T.addClass(X.legacy)},type:function(){if(aa.can.fit()){aa.verbose("Modal fits on screen");if(!aa.others.active()&&!aa.others.animating()){aa.remove.scrolling();aa.bind.scrollLock()}}else{if(!T.hasClass("bottom")){aa.verbose("Modal cannot fit on screen setting to scrolling");aa.set.scrolling()}else{aa.verbose("Bottom aligned modal not fitting on screen is unsupported for scrolling")}}},undetached:function(){q.addClass(X.undetached)}},setting:function(B,A){aa.debug("Changing setting",B,A);if(h.isPlainObject(B)){h.extend(true,l,B)}else{if(A!==g){if(h.isPlainObject(l[B])){h.extend(true,l[B],A)}else{l[B]=A}}else{return l[B]}}},internal:function(B,A){if(h.isPlainObject(B)){h.extend(true,aa,B)}else{if(A!==g){aa[B]=A}else{return aa[B]}}},debug:function(){if(!l.silent&&l.debug){if(l.performance){aa.performance.log(arguments)}else{aa.debug=Function.prototype.bind.call(console.info,console,l.name+":");aa.debug.apply(console,arguments)}}},verbose:function(){if(!l.silent&&l.verbose&&l.debug){if(l.performance){aa.performance.log(arguments)}else{aa.verbose=Function.prototype.bind.call(console.info,console,l.name+":");aa.verbose.apply(console,arguments)}}},error:function(){if(!l.silent){aa.error=Function.prototype.bind.call(console.error,console,l.name+":");aa.error.apply(console,arguments)}},performance:{log:function(B){var C,A,D;if(l.performance){C=new Date().getTime();D=x||C;A=C-D;x=C;d.push({Name:B[0],Arguments:[].slice.call(B,1)||"",Element:Z,"Execution Time":A})}clearTimeout(aa.performance.timer);aa.performance.timer=setTimeout(aa.performance.display,500)},display:function(){var A=l.name+":",B=0;x=false;clearTimeout(aa.performance.timer);h.each(d,function(D,C){B+=C["Execution Time"]});A+=" "+B+"ms";if(s){A+=" '"+s+"'"}if((console.group!==g||console.table!==g)&&d.length>0){console.groupCollapsed(A);if(console.table){console.table(d)}else{h.each(d,function(D,C){console.log(C.Name+": "+C["Execution Time"]+"ms")})}console.groupEnd()}d=[]}},invoke:function(B,F,D){var E=k,A,C,G;F=F||b;D=Z||D;if(typeof B=="string"&&E!==g){B=B.split(/[\. ]/);A=B.length-1;h.each(B,function(H,I){var J=(H!=A)?I+B[H+1].charAt(0).toUpperCase()+B[H+1].slice(1):B;if(h.isPlainObject(E[J])&&(H!=A)){E=E[J]}else{if(E[J]!==g){C=E[J];return false}else{if(h.isPlainObject(E[I])&&(H!=A)){E=E[I]}else{if(E[I]!==g){C=E[I];return false}else{return false}}}}})}if(h.isFunction(C)){G=C.apply(D,F)}else{if(C!==g){G=C}}if(Array.isArray(w)){w.push(G)}else{if(w!==g){w=[w,G]}else{if(G!==g){w=G}}}return C}};if(z){if(k===g){aa.initialize()}aa.invoke(r)}else{if(k!==g){k.invoke("destroy")}aa.initialize()}});return(w!==g)?w:this};h.fn.modal.settings={name:"Modal",namespace:"modal",useFlex:"auto",offset:0,silent:false,debug:false,verbose:false,performance:true,observeChanges:false,allowMultiple:false,detachable:true,closable:true,autofocus:true,restoreFocus:true,inverted:false,blurring:false,centered:true,dimmerSettings:{closable:false,useCSS:true},keyboardShortcuts:true,context:"body",queue:false,duration:500,transition:"scale",padding:50,scrollbarWidth:10,onShow:function(){},onVisible:function(){},onHide:function(){return true},onHidden:function(){},onApprove:function(){return true},onDeny:function(){return true},selector:{close:"> .close",approve:".actions .positive, .actions .approve, .actions .ok",deny:".actions .negative, .actions .deny, .actions .cancel",modal:".ui.modal",dimmer:"> .ui.dimmer",bodyFixed:"> .ui.fixed.menu, > .ui.right.toast-container, > .ui.right.sidebar"},error:{dimmer:"UI Dimmer, a required component is not included in this page",method:"The method you called is not defined.",notFound:"The element you specified could not be found"},className:{active:"active",animating:"animating",blurring:"blurring",inverted:"inverted",legacy:"legacy",loading:"loading",scrolling:"scrolling",undetached:"undetached",front:"front"}}})(jQuery,window,document);