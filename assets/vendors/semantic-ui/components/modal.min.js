/*!
 * # Fomantic-UI - Modal
 * http://github.com/fomantic/Fomantic-UI/
 *
 *
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
;(function(c,b,a,d){c.isFunction=c.isFunction||function(e){return typeof e==="function"&&typeof e.nodeType!=="number"};b=(typeof b!="undefined"&&b.Math==Math)?b:(typeof self!="undefined"&&self.Math==Math)?self:Function("return this")();c.fn.modal=function(q){var o=c(this),f=c(b),i=c(a),j=c("body"),l=o.selector||"",g=new Date().getTime(),n=[],m=arguments[0],e=(typeof m=="string"),p=[].slice.call(arguments,1),k=b.requestAnimationFrame||b.mozRequestAnimationFrame||b.webkitRequestAnimationFrame||b.msRequestAnimationFrame||function(r){setTimeout(r,0)},h;o.each(function(){var M=(c.isPlainObject(q))?c.extend(true,{},c.fn.modal.settings,q):c.extend({},c.fn.modal.settings),L=M.selector,u=M.className,B=M.namespace,J=M.error,G="."+B,C="module-"+B,w=c(this),F=c(M.context),v=w.find(L.close),P,A,I,y,H,t=this,N=w.data(C),r=false,z,D,x="",O,E,K,s;s={initialize:function(){s.verbose("Initializing dimmer",F);s.create.id();s.create.dimmer();if(M.allowMultiple){s.create.innerDimmer()}if(!M.centered){w.addClass("top aligned")}s.refreshModals();s.bind.events();if(M.observeChanges){s.observeChanges()}s.instantiate()},instantiate:function(){s.verbose("Storing instance of modal");N=s;w.data(C,N)},create:{dimmer:function(){var Q={debug:M.debug,dimmerName:"modals"},R=c.extend(true,Q,M.dimmerSettings);if(c.fn.dimmer===d){s.error(J.dimmer);return}s.debug("Creating dimmer");y=F.dimmer(R);if(M.detachable){s.verbose("Modal is detachable, moving content into dimmer");y.dimmer("add content",w)}else{s.set.undetached()}H=y.dimmer("get dimmer")},id:function(){E=(Math.random().toString(16)+"000000000").substr(2,8);O="."+E;s.verbose("Creating unique id for element",E)},innerDimmer:function(){if(w.find(L.dimmer).length==0){w.prepend('<div class="ui inverted dimmer"></div>')}}},destroy:function(){if(K){K.disconnect()}s.verbose("Destroying previous modal");w.removeData(C).off(G);f.off(O);H.off(O);v.off(G);F.dimmer("destroy")},observeChanges:function(){if("MutationObserver" in b){K=new MutationObserver(function(Q){s.debug("DOM tree modified, refreshing");s.refresh()});K.observe(t,{childList:true,subtree:true});s.debug("Setting up mutation observer",K)}},refresh:function(){s.remove.scrolling();s.cacheSizes();if(!s.can.useFlex()){s.set.modalOffset()}s.set.screenHeight();s.set.type()},refreshModals:function(){A=w.siblings(L.modal);P=A.add(w)},attachEvents:function(Q,S){var R=c(Q);S=c.isFunction(s[S])?s[S]:s.toggle;if(R.length>0){s.debug("Attaching modal events to element",Q,S);R.off(G).on("click"+G,S)}else{s.error(J.notFound,Q)}},bind:{events:function(){s.verbose("Attaching events");w.on("click"+G,L.close,s.event.close).on("click"+G,L.approve,s.event.approve).on("click"+G,L.deny,s.event.deny);f.on("resize"+O,s.event.resize)},scrollLock:function(){y.get(0).addEventListener("touchmove",s.event.preventScroll,{passive:false})}},unbind:{scrollLock:function(){y.get(0).removeEventListener("touchmove",s.event.preventScroll,{passive:false})}},get:{id:function(){return(Math.random().toString(16)+"000000000").substr(2,8)}},event:{approve:function(){if(r||M.onApprove.call(t,c(this))===false){s.verbose("Approve callback returned false cancelling hide");return}r=true;s.hide(function(){r=false})},preventScroll:function(Q){if(Q.target.className.indexOf("dimmer")!==-1){Q.preventDefault()}},deny:function(){if(r||M.onDeny.call(t,c(this))===false){s.verbose("Deny callback returned false cancelling hide");return}r=true;s.hide(function(){r=false})},close:function(){s.hide()},mousedown:function(R){var Q=c(R.target);z=(Q.closest(L.modal).length>0);if(z){s.verbose("Mouse down event registered inside the modal")}D=s.is.scrolling()&&c(b).outerWidth()-M.scrollbarWidth<=R.clientX;if(D){s.verbose("Mouse down event registered inside the scrollbar")}},mouseup:function(T){if(!M.closable){s.verbose("Dimmer clicked but closable setting is disabled");return}if(z){s.debug("Dimmer clicked but mouse down was initially registered inside the modal");return}if(D){s.debug("Dimmer clicked but mouse down was initially registered inside the scrollbar");return}var R=c(T.target),S=(R.closest(L.modal).length>0),Q=c.contains(a.documentElement,T.target);if(!S&&Q&&s.is.active()&&w.hasClass(u.front)){s.debug("Dimmer clicked, hiding all modals");if(M.allowMultiple){if(!s.hideAll()){return}}else{if(!s.hide()){return}}s.remove.clickaway()}},debounce:function(R,Q){clearTimeout(s.timer);s.timer=setTimeout(R,Q)},keyboard:function(R){var S=R.which,Q=27;if(S==Q){if(M.closable){s.debug("Escape key pressed hiding modal");if(w.hasClass(u.front)){s.hide()}}else{s.debug("Escape key pressed, but closable is set to false")}R.preventDefault()}},resize:function(){if(y.dimmer("is active")&&(s.is.animating()||s.is.active())){k(s.refresh)}}},toggle:function(){if(s.is.active()||s.is.animating()){s.hide()}else{s.show()}},show:function(Q){Q=c.isFunction(Q)?Q:function(){};s.refreshModals();s.set.dimmerSettings();s.set.dimmerStyles();s.showModal(Q)},hide:function(Q){Q=c.isFunction(Q)?Q:function(){};s.refreshModals();return s.hideModal(Q)},showModal:function(Q){Q=c.isFunction(Q)?Q:function(){};if(s.is.animating()||!s.is.active()){s.showDimmer();s.cacheSizes();if(s.can.useFlex()){s.remove.legacy()}else{s.set.legacy();s.set.modalOffset();s.debug("Using non-flex legacy modal positioning.")}s.set.screenHeight();s.set.type();s.set.clickaway();if(!M.allowMultiple&&s.others.active()){s.hideOthers(s.showModal)}else{r=false;if(M.allowMultiple){if(s.others.active()){A.filter("."+u.active).find(L.dimmer).addClass("active")}if(M.detachable){w.detach().appendTo(H)}}M.onShow.call(t);if(M.transition&&c.fn.transition!==d&&w.transition("is supported")){s.debug("Showing modal with css animations");w.transition({debug:M.debug,animation:M.transition+" in",queue:M.queue,duration:M.duration,useFailSafe:true,onComplete:function(){M.onVisible.apply(t);if(M.keyboardShortcuts){s.add.keyboardShortcuts()}s.save.focus();s.set.active();if(M.autofocus){s.set.autofocus()}Q()}})}else{s.error(J.noTransition)}}}else{s.debug("Modal is already visible")}},hideModal:function(T,Q,S){var R=A.filter("."+u.active).last();T=c.isFunction(T)?T:function(){};s.debug("Hiding modal");if(M.onHide.call(t,c(this))===false){s.verbose("Hide callback returned false cancelling hide");r=false;return false}if(s.is.animating()||s.is.active()){if(M.transition&&c.fn.transition!==d&&w.transition("is supported")){s.remove.active();w.transition({debug:M.debug,animation:M.transition+" out",queue:M.queue,duration:M.duration,useFailSafe:true,onStart:function(){if(!s.others.active()&&!s.others.animating()&&!Q){s.hideDimmer()}if(M.keyboardShortcuts&&!s.others.active()){s.remove.keyboardShortcuts()}},onComplete:function(){s.unbind.scrollLock();if(M.allowMultiple){R.addClass(u.front);w.removeClass(u.front);if(S){P.find(L.dimmer).removeClass("active")}else{R.find(L.dimmer).removeClass("active")}}M.onHidden.call(t);s.remove.dimmerStyles();s.restore.focus();T()}})}else{s.error(J.noTransition)}}},showDimmer:function(){if(y.dimmer("is animating")||!y.dimmer("is active")){s.save.bodyMargin();s.debug("Showing dimmer");y.dimmer("show")}else{s.debug("Dimmer already visible")}},hideDimmer:function(){if(y.dimmer("is animating")||(y.dimmer("is active"))){s.unbind.scrollLock();y.dimmer("hide",function(){s.restore.bodyMargin();s.remove.clickaway();s.remove.screenHeight()})}else{s.debug("Dimmer is not visible cannot hide");return}},hideAll:function(S){var R=P.filter("."+u.active+", ."+u.animating);S=c.isFunction(S)?S:function(){};if(R.length>0){s.debug("Hiding all visible modals");var Q=true;c(R.get().reverse()).each(function(T,U){if(Q){Q=c(U).modal("hide modal",S,false,true)}});if(Q){s.hideDimmer()}return Q}},hideOthers:function(R){var Q=A.filter("."+u.active+", ."+u.animating);R=c.isFunction(R)?R:function(){};if(Q.length>0){s.debug("Hiding other modals",A);Q.modal("hide modal",R,true)}},others:{active:function(){return(A.filter("."+u.active).length>0)},animating:function(){return(A.filter("."+u.animating).length>0)}},add:{keyboardShortcuts:function(){s.verbose("Adding keyboard shortcuts");i.on("keyup"+G,s.event.keyboard)}},save:{focus:function(){var Q=c(a.activeElement),R=Q.closest(w).length>0;if(!R){I=c(a.activeElement).blur()}},bodyMargin:function(){x=j.css("margin-right");var Q=parseInt(x.replace(/[^\d.]/g,"")),S=b.innerWidth-a.documentElement.clientWidth,R=Q+S;j.css("margin-right",R+"px");j.find(L.bodyFixed).css("padding-right",R+"px")}},restore:{focus:function(){if(I&&I.length>0&&M.restoreFocus){I.focus()}},bodyMargin:function(){j.css("margin-right",x);j.find(L.bodyFixed).css("padding-right",x)}},remove:{active:function(){w.removeClass(u.active)},legacy:function(){w.removeClass(u.legacy)},clickaway:function(){H.off("mousedown"+O);H.off("mouseup"+O)},dimmerStyles:function(){H.removeClass(u.inverted);y.removeClass(u.blurring)},bodyStyle:function(){if(j.attr("style")===""){s.verbose("Removing style attribute");j.removeAttr("style")}},screenHeight:function(){s.debug("Removing page height");j.css("height","")},keyboardShortcuts:function(){s.verbose("Removing keyboard shortcuts");i.off("keyup"+G)},scrolling:function(){y.removeClass(u.scrolling);w.removeClass(u.scrolling)}},cacheSizes:function(){w.addClass(u.loading);var S=w.prop("scrollHeight"),Q=w.outerWidth(),R=w.outerHeight();if(s.cache===d||R!==0){s.cache={pageHeight:c(a).outerHeight(),width:Q,height:R+M.offset,scrollHeight:S+M.offset,contextHeight:(M.context=="body")?c(b).height():y.height()};s.cache.topOffset=-(s.cache.height/2)}w.removeClass(u.loading);s.debug("Caching modal and container sizes",s.cache)},can:{useFlex:function(){return(M.useFlex=="auto")?M.detachable&&!s.is.ie():M.useFlex},fit:function(){var R=s.cache.contextHeight,T=s.cache.contextHeight/2,S=s.cache.topOffset,V=s.cache.scrollHeight,Q=s.cache.height,W=M.padding,U=(T+S);return(V>Q)?(U+V+W<R):(Q+(W*2)<R)}},is:{active:function(){return w.hasClass(u.active)},ie:function(){var R=(!(b.ActiveXObject)&&"ActiveXObject" in b),Q=("ActiveXObject" in b);return(R||Q)},animating:function(){return w.transition("is supported")?w.transition("is animating"):w.is(":visible")},scrolling:function(){return y.hasClass(u.scrolling)},modernBrowser:function(){return !(b.ActiveXObject||"ActiveXObject" in b)}},set:{autofocus:function(){var Q=w.find("[tabindex], :input").filter(":visible").filter(function(){return c(this).closest(".disabled").length===0}),R=Q.filter("[autofocus]"),S=(R.length>0)?R.first():Q.first();if(S.length>0){S.focus()}},clickaway:function(){H.on("mousedown"+O,s.event.mousedown);H.on("mouseup"+O,s.event.mouseup)},dimmerSettings:function(){if(c.fn.dimmer===d){s.error(J.dimmer);return}var Q={debug:M.debug,dimmerName:"modals",closable:"auto",useFlex:s.can.useFlex(),duration:{show:M.duration,hide:M.duration}},R=c.extend(true,Q,M.dimmerSettings);if(M.inverted){R.variation=(R.variation!==d)?R.variation+" inverted":"inverted"}F.dimmer("setting",R)},dimmerStyles:function(){if(M.inverted){H.addClass(u.inverted)}else{H.removeClass(u.inverted)}if(M.blurring){y.addClass(u.blurring)}else{y.removeClass(u.blurring)}},modalOffset:function(){var R=s.cache.width,Q=s.cache.height;w.css({marginTop:(!w.hasClass("aligned")&&s.can.fit())?-(Q/2):0,marginLeft:-(R/2)});s.verbose("Setting modal offset for legacy mode")},screenHeight:function(){if(s.can.fit()){j.css("height","")}else{if(!w.hasClass("bottom")){s.debug("Modal is taller than page content, resizing page height");j.css("height",s.cache.height+(M.padding*2))}}},active:function(){w.addClass(u.active+" "+u.front);A.filter("."+u.active).removeClass(u.front)},scrolling:function(){y.addClass(u.scrolling);w.addClass(u.scrolling);s.unbind.scrollLock()},legacy:function(){w.addClass(u.legacy)},type:function(){if(s.can.fit()){s.verbose("Modal fits on screen");if(!s.others.active()&&!s.others.animating()){s.remove.scrolling();s.bind.scrollLock()}}else{if(!w.hasClass("bottom")){s.verbose("Modal cannot fit on screen setting to scrolling");s.set.scrolling()}else{s.verbose("Bottom aligned modal not fitting on screen is unsupported for scrolling")}}},undetached:function(){y.addClass(u.undetached)}},setting:function(Q,R){s.debug("Changing setting",Q,R);if(c.isPlainObject(Q)){c.extend(true,M,Q)}else{if(R!==d){if(c.isPlainObject(M[Q])){c.extend(true,M[Q],R)}else{M[Q]=R}}else{return M[Q]}}},internal:function(Q,R){if(c.isPlainObject(Q)){c.extend(true,s,Q)}else{if(R!==d){s[Q]=R}else{return s[Q]}}},debug:function(){if(!M.silent&&M.debug){if(M.performance){s.performance.log(arguments)}else{s.debug=Function.prototype.bind.call(console.info,console,M.name+":");s.debug.apply(console,arguments)}}},verbose:function(){if(!M.silent&&M.verbose&&M.debug){if(M.performance){s.performance.log(arguments)}else{s.verbose=Function.prototype.bind.call(console.info,console,M.name+":");s.verbose.apply(console,arguments)}}},error:function(){if(!M.silent){s.error=Function.prototype.bind.call(console.error,console,M.name+":");s.error.apply(console,arguments)}},performance:{log:function(S){var R,T,Q;if(M.performance){R=new Date().getTime();Q=g||R;T=R-Q;g=R;n.push({Name:S[0],Arguments:[].slice.call(S,1)||"",Element:t,"Execution Time":T})}clearTimeout(s.performance.timer);s.performance.timer=setTimeout(s.performance.display,500)},display:function(){var R=M.name+":",Q=0;g=false;clearTimeout(s.performance.timer);c.each(n,function(S,T){Q+=T["Execution Time"]});R+=" "+Q+"ms";if(l){R+=" '"+l+"'"}if((console.group!==d||console.table!==d)&&n.length>0){console.groupCollapsed(R);if(console.table){console.table(n)}else{c.each(n,function(S,T){console.log(T.Name+": "+T["Execution Time"]+"ms")})}console.groupEnd()}n=[]}},invoke:function(V,R,T){var S=N,W,U,Q;R=R||p;T=t||T;if(typeof V=="string"&&S!==d){V=V.split(/[\. ]/);W=V.length-1;c.each(V,function(Z,Y){var X=(Z!=W)?Y+V[Z+1].charAt(0).toUpperCase()+V[Z+1].slice(1):V;if(c.isPlainObject(S[X])&&(Z!=W)){S=S[X]}else{if(S[X]!==d){U=S[X];return false}else{if(c.isPlainObject(S[Y])&&(Z!=W)){S=S[Y]}else{if(S[Y]!==d){U=S[Y];return false}else{return false}}}}})}if(c.isFunction(U)){Q=U.apply(T,R)}else{if(U!==d){Q=U}}if(Array.isArray(h)){h.push(Q)}else{if(h!==d){h=[h,Q]}else{if(Q!==d){h=Q}}}return U}};if(e){if(N===d){s.initialize()}s.invoke(m)}else{if(N!==d){N.invoke("destroy")}s.initialize()}});return(h!==d)?h:this};c.fn.modal.settings={name:"Modal",namespace:"modal",useFlex:"auto",offset:0,silent:false,debug:false,verbose:false,performance:true,observeChanges:false,allowMultiple:false,detachable:true,closable:true,autofocus:true,restoreFocus:true,inverted:false,blurring:false,centered:true,dimmerSettings:{closable:false,useCSS:true},keyboardShortcuts:true,context:"body",queue:false,duration:500,transition:"scale",padding:50,scrollbarWidth:10,onShow:function(){},onVisible:function(){},onHide:function(){return true},onHidden:function(){},onApprove:function(){return true},onDeny:function(){return true},selector:{close:"> .close",approve:".actions .positive, .actions .approve, .actions .ok",deny:".actions .negative, .actions .deny, .actions .cancel",modal:".ui.modal",dimmer:"> .ui.dimmer",bodyFixed:"> .ui.fixed.menu, > .ui.right.toast-container, > .ui.right.sidebar"},error:{dimmer:"UI Dimmer, a required component is not included in this page",method:"The method you called is not defined.",notFound:"The element you specified could not be found"},className:{active:"active",animating:"animating",blurring:"blurring",inverted:"inverted",legacy:"legacy",loading:"loading",scrolling:"scrolling",undetached:"undetached",front:"front"}}})(jQuery,window,document);